
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Zones of Regulation</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f7f7f7;
      color: #333;
      margin: 0;
      padding: 20px;
    }
    h1 {
      text-align: center;
      margin-bottom: 10px;
      font-size: 24px;
    }
    .zone-container {
      display: flex;
      justify-content: space-around;
      margin-top: 20px;
      gap: 10px;
      flex-wrap: wrap;
    }
    .zone {
      width: 22%;
      min-height: 200px;
      padding: 10px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    #blue { background: #cce0f9; }
    #green { background: #d4f8d4; }
    #yellow { background: #fffacc; }
    #red { background: #ffd6d6; }

    .student {
      background: #fff;
      margin: 5px;
      padding: 8px;
      border-radius: 6px;
      cursor: grab;
      box-shadow: 1px 1px 4px rgba(0,0,0,0.1);
      text-align: center;
    }

    .zone .icon {
      font-size: 20px;
      margin: 3px;
    }

    #students {
      max-width: 600px;
      margin: 0 auto;
      text-align: center;
      margin-top: 20px;
    }
  
    .student-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
      gap: 8px;
      max-height: 200px;
      overflow-y: auto;
      padding: 10px;
      background: #ffffffaa;
      border-radius: 10px;
      box-shadow: inset 0 0 5px rgba(0,0,0,0.1);
    }
    
  
    .student.disabled {
      cursor: not-allowed;
    }

    #resetButton {
      background-color: #d6ecff;
      color: #333;
      padding: 6px 10px;
      border: none;
      border-radius: 6px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      cursor: pointer;
      font-weight: bold;
    }

    #resetButton:hover {
      background-color: #c0e0ff;
    }
    
  
    .student.disabled {
      cursor: not-allowed;
    }

    .student-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
      gap: 8px;
      max-height: none;
      padding: 10px;
      background: #ffffffaa;
      border-radius: 10px;
      box-shadow: inset 0 0 5px rgba(0,0,0,0.1);
      justify-items: center;
    }

    .student-grid.wide-grid {
      max-width: 100%;
      margin: 0 auto;
    }

    #resetButton, #toggleBeesButton {
      background-color: #d6ecff;
      color: #333;
      padding: 6px 10px;
      border: none;
      border-radius: 6px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      cursor: pointer;
      font-weight: bold;
    }

    #resetButton:hover, #toggleBeesButton:hover {
      background-color: #c0e0ff;
    }
    
    .student.disabled {
      cursor: not-allowed;
    }

    .student-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
      gap: 8px;
      max-height: none;
      padding: 10px;
      background: #ffffffaa;
      border-radius: 10px;
      box-shadow: inset 0 0 5px rgba(0,0,0,0.1);
      justify-items: center;
    }

    .student-grid.wide-grid {
      max-width: 100%;
      margin: 0 auto;
    }

    #topToolbar {
      position: fixed;
      top: 0;
      width: 100%;
      background-color: #e6f2ff;
      padding: 10px;
      display: flex;
      justify-content: center;
      gap: 15px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      z-index: 1000;
    }

    #resetButton, #toggleBeesButton, #dashboardLink {
      background-color: #d6ecff;
      color: #333;
      padding: 6px 10px;
      border: none;
      border-radius: 6px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      cursor: pointer;
      font-weight: bold;
      text-decoration: none;
      display: inline-block;
    }

    #resetButton:hover, #toggleBeesButton:hover, #dashboardLink:hover {
      background-color: #c0e0ff;
    }

    body {
      padding-top: 60px;
    }
    
/* /* removed glitch-causing nav style */ removed */ {
  position: fixed;
  top: 50%;
  left: 10px;
  transform: translateY(-50%);
  display: flex;
  flex-direction: column;
  gap: 10px;
  z-index: 999;
}
/* /* removed nav-button style */ removed */ {
  background-color: #d6ecff;
  padding: 10px 12px;
  border-radius: 8px;
  text-decoration: none;
  color: #333;
  font-weight: bold;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  text-align: center;
}
/* /* removed nav-button style */ removed */:hover {
  background-color: #b8dcff;
}

</style>


</head>
<body>

<!-- sideNav removed -->
  
  
</div>


<div id="topToolbar">
  <button onclick="resetClass()" id="resetButton">‚ü≥ Reset Class</button>
  <button onclick="toggleBees()" id="toggleBeesButton">üëÅÔ∏è Toggle Bees</button>
  <a href="teacher-dashboard.html" id="dashboardLink">üìä Teacher Dashboard</a>
</div>

  <h1>üêù How are you feeling today?</h1>

  <div class="zone-container">
    <div class="zone" id="blue" ondrop="drop(event)" ondragover="allowDrop(event)">
      <h3>üîµ Blue Zone</h3>
      <div id="blueZoneContent"></div>
    </div>
    <div class="zone" id="green" ondrop="drop(event)" ondragover="allowDrop(event)">
      <h3>üü¢ Green Zone</h3>
      <div id="greenZoneContent"></div>
    </div>
    <div class="zone" id="yellow" ondrop="drop(event)" ondragover="allowDrop(event)">
      <h3>üü° Yellow Zone</h3>
      <div id="yellowZoneContent"></div>
    </div>
    <div class="zone" id="red" ondrop="drop(event)" ondragover="allowDrop(event)">
      <h3>üî¥ Red Zone</h3>
      <div id="redZoneContent"></div>
    </div>
  </div>

  
      <div id="students">
  <div class="student-grid wide-grid">
    <div class="student" draggable="true">Adella</div><div class="student" draggable="true">Aiden</div><div class="student" draggable="true">Kaileb</div><div class="student" draggable="true">Tahmila</div><div class="student" draggable="true">Max</div><div class="student" draggable="true">Liam</div><div class="student" draggable="true">Kaydence</div><div class="student" draggable="true">Jackson</div><div class="student" draggable="true">Jack</div><div class="student" draggable="true">Amy</div><div class="student" draggable="true">Anna</div><div class="student" draggable="true">Parker</div><div class="student" draggable="true">Maia</div><div class="student" draggable="true">Mallakai</div><div class="student" draggable="true">Cooper</div><div class="student" draggable="true">Tyson</div><div class="student" draggable="true">Harper</div><div class="student" draggable="true">Kamoura</div><div class="student" draggable="true">Hayden</div><div class="student" draggable="true">Emily</div><div class="student" draggable="true">Rylee</div><div class="student" draggable="true">Kate-Lyn</div><div class="student" draggable="true">Fox</div>
  </div>
</div>
  </div>

  
  <script>
    function allowDrop(ev) {
      ev.preventDefault();
    }

    function drop(ev) {
      ev.preventDefault();
      const name = ev.dataTransfer.getData("text");
      const zone = ev.currentTarget.id;
      const date = new Date().toISOString().split('T')[0];
      const key = "zoneLog-DefaultClass";

      let log = JSON.parse(localStorage.getItem(key) || "[]");
      log.push({ name, zone, date });
      localStorage.setItem(key, JSON.stringify(log));

      const icon = document.createElement("div");
      icon.className = "icon";
      icon.textContent = "üêù";
      icon.dataset.name = name;
      ev.currentTarget.querySelector("div").appendChild(icon);

      document.querySelectorAll('.student').forEach(s => {
        if (s.textContent === name) {
          s.classList.add('disabled');
          s.style.opacity = '0.4';
          s.setAttribute('draggable', 'false');
        }
      });
    }

    function resetClass() {
      const date = new Date().toISOString().split('T')[0];
      const key = "zoneLog-DefaultClass";
      let log = JSON.parse(localStorage.getItem(key) || "[]");
      log = log.filter(entry => entry.date !== date);
      localStorage.setItem(key, JSON.stringify(log));

      document.querySelectorAll('.student').forEach(s => {
        s.classList.remove('disabled');
        s.style.opacity = '1';
        s.setAttribute('draggable', 'true');
      });

      document.querySelectorAll('.zone .icon').forEach(icon => icon.remove());
    }

    window.addEventListener('DOMContentLoaded', () => {
      document.querySelectorAll('.student').forEach(el => {
        el.addEventListener('dragstart', (e) => {
          if (el.classList.contains('disabled')) {
            e.preventDefault();
          } else {
            e.dataTransfer.setData("text", e.target.textContent);
          }
        });

        el.addEventListener('dblclick', () => {
          el.classList.remove('disabled');
          el.style.opacity = '1';
          el.setAttribute('draggable', 'true');

          document.querySelectorAll('.zone').forEach(zone => {
            const icons = zone.querySelectorAll('.icon');
            icons.forEach(icon => {
              if (!icon.dataset.name || icon.dataset.name === el.textContent) {
                icon.remove();
              }
            });
          });

          const date = new Date().toISOString().split('T')[0];
          const key = "zoneLog-DefaultClass";
          let log = JSON.parse(localStorage.getItem(key) || "[]");
          log = log.filter(entry => !(entry.name === el.textContent && entry.date === date));
          localStorage.setItem(key, JSON.stringify(log));
        });
      });
    });
  
    function toggleBees() {
      const icons = document.querySelectorAll('.zone .icon');
      icons.forEach(icon => {
        icon.style.display = icon.style.display === 'none' ? 'inline-block' : 'none';
      });
    }
    </script>


<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.5.0/firebase-app.js";
  import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.5.0/firebase-auth.js";
  import { getFirestore, doc, setDoc, getDoc, updateDoc, arrayUnion } from "https://www.gstatic.com/firebasejs/11.5.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBTmZv-gavHAECU5kqjTyrdABfsk_oonsM",
    authDomain: "zonesdashboard.firebaseapp.com",
    projectId: "zonesdashboard",
    storageBucket: "zonesdashboard.firebasestorage.app",
    messagingSenderId: "121203751843",
    appId: "1:121203751843:web:1ccb23a0fcbd09fe25b816",
    measurementId: "G-CB8EVKZ0HF"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth();
  const db = getFirestore(app);

  let currentUser = null;

  onAuthStateChanged(auth, async (user) => {
    if (user) {
      currentUser = user;
      window.currentUserId = user.uid;
    } else {
      window.location.href = "login.html";
    }
  });

  window.saveCheckIn = async function(name, zone, date) {
    if (!currentUser) return;

    const logRef = doc(db, "users", currentUser.uid, "logs", date);
    const logSnap = await getDoc(logRef);

    if (!logSnap.exists()) {
      await setDoc(logRef, { entries: [{ name, zone }] });
    } else {
      await updateDoc(logRef, {
        entries: arrayUnion({ name, zone })
      });
    }
  };
</script>


<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.5.0/firebase-app.js";
  import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.5.0/firebase-auth.js";
  import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/11.5.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBTmZv-gavHAECU5kqjTyrdABfsk_oonsM",
    authDomain: "zonesdashboard.firebaseapp.com",
    projectId: "zonesdashboard",
    storageBucket: "zonesdashboard.firebasestorage.app",
    messagingSenderId: "121203751843",
    appId: "1:121203751843:web:1ccb23a0fcbd09fe25b816",
    measurementId: "G-CB8EVKZ0HF"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth();
  const db = getFirestore(app);

  onAuthStateChanged(auth, async (user) => {
    if (!user) return window.location.href = "login.html";

    const uid = user.uid;
    const classDoc = doc(db, "users", uid, "classes", "Default");
    const snapshot = await getDoc(classDoc);

    let students = [];
    if (snapshot.exists()) {
      students = snapshot.data().students || [];
    } else {
      // Initial list (first-time login)
      students = [
        "Adella", "Aiden", "Kaileb", "Tahmila", "Max", "Liam", "Kaydence", "Jackson",
        "Jack", "Amy", "Anna", "Parker", "Maia", "Mallakai", "Cooper", "Tyson", "Harper",
        "Kamoura", "Hayden", "Emily", "Rylee", "Kate-Lyn", "Fox"
      ];
      await setDoc(classDoc, { students });
    }

    // Display students
    const grid = document.querySelector(".student-grid");
    grid.innerHTML = "";
    students.forEach(name => {
      const div = document.createElement("div");
      div.className = "student";
      div.textContent = name;
      div.setAttribute("draggable", "true");
      grid.appendChild(div);
    });

    // Enable drag + reset functions
    initStudentListeners();
  });

  function initStudentListeners() {
    document.querySelectorAll('.student').forEach(el => {
      el.addEventListener('dragstart', (e) => {
        if (el.classList.contains('disabled')) {
          e.preventDefault();
        } else {
          e.dataTransfer.setData("text", e.target.textContent);
        }
      });

      el.addEventListener('dblclick', () => {
        el.classList.remove('disabled');
        el.style.opacity = '1';
        el.setAttribute('draggable', 'true');

        document.querySelectorAll('.zone').forEach(zone => {
          const icons = zone.querySelectorAll('.icon');
          icons.forEach(icon => {
            if (!icon.dataset.name || icon.dataset.name === el.textContent) {
              icon.remove();
            }
          });
        });
      });
    });
  }
</script>

</body>
</html>
